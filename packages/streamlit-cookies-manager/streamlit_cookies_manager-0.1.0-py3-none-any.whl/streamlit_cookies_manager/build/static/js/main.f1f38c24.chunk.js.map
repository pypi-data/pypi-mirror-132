{"version":3,"sources":["index.ts"],"names":["topDocument","window","top","document","lastValue","Streamlit","events","addEventListener","RENDER_EVENT","event","queue","data","detail","console","log","args","Object","keys","forEach","name","spec","value","cookie","encodeURIComponent","path","date","Date","expires_at","toUTCString","newValue","saveOnly","setComponentValue","setComponentReady","setFrameHeight"],"mappings":"oIAAA,kBAGMA,GADoBC,OAAOC,KAAOD,QACVE,SAE1BC,EAA2B,KA2B/BC,IAAUC,OAAOC,iBAAiBF,IAAUG,cAZ5C,SAAkBC,GACd,IAgBiBC,EAhBXC,EAAQF,EAAkCG,OAChDC,QAAQC,IAAI,OAAQH,EAAKI,MAeRL,EAdLC,EAAKI,KAAL,MAeZC,OAAOC,KAAKP,GAAOQ,SAAQ,SAACC,GACxB,IAAMC,EAAOV,EAAMS,GACnB,GAAmB,OAAfC,EAAKC,MACLrB,EAAYsB,OAAZ,UAAwBC,mBAAmBJ,GAA3C,mBAA2DI,mBAAmBH,EAAKI,WAClF,CACD,IAAMC,EAAO,IAAIC,KAAKN,EAAKO,YAC3B3B,EAAYsB,OACR,UAAGC,mBAAmBJ,GAAtB,YAA+BI,mBAAmBH,EAAKC,OAAvD,wBACYI,EAAKG,cADjB,qBAESL,mBAAmBH,EAAKI,MAFjC,KAIJX,QAAQC,IAAI,UAAGS,mBAAmBJ,GAAtB,YAA+BI,mBAAmBH,EAAKC,OAAvD,wBACII,EAAKG,cADT,qBAECL,mBAAmBH,EAAKI,MAFzB,UAxBpB,IAAMK,EAAW7B,EAAYsB,OACzBlB,IAAcyB,GAAalB,EAAKI,KAAKe,WACrCzB,IAAU0B,kBAAkBF,GAC5BzB,EAAYyB,MAKpBxB,IAAU2B,oBACV3B,IAAU4B,eAAe,K","file":"static/js/main.f1f38c24.chunk.js","sourcesContent":["import {RenderData, Streamlit} from \"streamlit-component-lib\"\n\nconst topWindow: Window = window.top || window\nconst topDocument = topWindow.document\n\nlet lastValue: string | null = null\n\ninterface AddCookieSpec {\n    value: string\n    expires_at: string\n    path: string\n}\n\ninterface DeleteCookieSpec {\n    value: null\n    path: string\n}\n\ntype CookieSpec = AddCookieSpec | DeleteCookieSpec\n\nfunction onRender(event: Event): void {\n    const data = (event as CustomEvent<RenderData>).detail\n    console.log('args', data.args)\n    saveCookies(data.args[\"queue\"])\n\n    const newValue = topDocument.cookie\n    if (lastValue !== newValue && !data.args.saveOnly) {\n        Streamlit.setComponentValue(newValue)\n        lastValue = newValue\n    }\n}\n\nStreamlit.events.addEventListener(Streamlit.RENDER_EVENT, onRender)\nStreamlit.setComponentReady()\nStreamlit.setFrameHeight(0)\n\n\nfunction saveCookies(queue: { [k in string]: CookieSpec }) {\n    Object.keys(queue).forEach((name) => {\n        const spec = queue[name]\n        if (spec.value === null)\n            topDocument.cookie = `${encodeURIComponent(name)}=; path=${encodeURIComponent(spec.path)}`\n        else {\n            const date = new Date(spec.expires_at)\n            topDocument.cookie = (\n                `${encodeURIComponent(name)}=${encodeURIComponent(spec.value)};` +\n                ` expires=${date.toUTCString()};` +\n                ` path=${encodeURIComponent(spec.path)};`\n            )\n            console.log(`${encodeURIComponent(name)}=${encodeURIComponent(spec.value)};` +\n                ` expires=${date.toUTCString()};` +\n                ` path=${encodeURIComponent(spec.path)};`)\n        }\n    })\n}"],"sourceRoot":""}