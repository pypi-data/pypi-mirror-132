
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/machine-learning/estimate_soccer_value_bets.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_machine-learning_estimate_soccer_value_bets.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_machine-learning_estimate_soccer_value_bets.py:


=================
Soccer value bets
=================

This example illustrates how to estimate value bets for soccer fixtures by 
training a machine learning multi-output classifier.

.. GENERATED FROM PYTHON SOURCE LINES 9-18

.. code-block:: default


    # Author: Georgios Douzas <gdouzas@icloud.com>
    # Licence: MIT

    import numpy as np
    import pandas as pd
    from sportsbet.datasets import SoccerDataLoader
    from sklearn.neighbors import KNeighborsClassifier








.. GENERATED FROM PYTHON SOURCE LINES 19-21

Extracting the training data
##############################################################################

.. GENERATED FROM PYTHON SOURCE LINES 23-25

We extract the training data for the spanish league. We also remove any
missing values and select the market average odds.

.. GENERATED FROM PYTHON SOURCE LINES 25-31

.. code-block:: default


    dataloader = SoccerDataLoader(param_grid={'league': ['Spain']})
    X_train, Y_train, _ = dataloader.extract_train_data(
        drop_na_thres=1.0, odds_type='market_average'
    )





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Football-Data.co.uk: ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00




.. GENERATED FROM PYTHON SOURCE LINES 32-33

The input data:

.. GENERATED FROM PYTHON SOURCE LINES 33-35

.. code-block:: default

    X_train






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>home_team</th>
          <th>away_team</th>
          <th>league</th>
          <th>division</th>
          <th>year</th>
          <th>home_team_soccer_power_index</th>
          <th>away_team_soccer_power_index</th>
          <th>home_team_probability_win</th>
          <th>away_team_probability_win</th>
          <th>probability_draw</th>
          <th>home_team_projected_score</th>
          <th>away_team_projected_score</th>
          <th>match_quality</th>
        </tr>
        <tr>
          <th>date</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>2016-08-19</th>
          <td>La Coruna</td>
          <td>Eibar</td>
          <td>Spain</td>
          <td>1</td>
          <td>2017</td>
          <td>66.52</td>
          <td>62.29</td>
          <td>0.5003</td>
          <td>0.2260</td>
          <td>0.2738</td>
          <td>1.47</td>
          <td>0.79</td>
          <td>64.335545</td>
        </tr>
        <tr>
          <th>2016-08-19</th>
          <td>Malaga</td>
          <td>Osasuna</td>
          <td>Spain</td>
          <td>1</td>
          <td>2017</td>
          <td>72.57</td>
          <td>56.93</td>
          <td>0.5475</td>
          <td>0.1897</td>
          <td>0.2628</td>
          <td>1.56</td>
          <td>0.70</td>
          <td>63.805561</td>
        </tr>
        <tr>
          <th>2016-08-19</th>
          <td>La Coruna</td>
          <td>Eibar</td>
          <td>Spain</td>
          <td>1</td>
          <td>2017</td>
          <td>66.52</td>
          <td>62.29</td>
          <td>0.5003</td>
          <td>0.2260</td>
          <td>0.2738</td>
          <td>1.47</td>
          <td>0.79</td>
          <td>64.335545</td>
        </tr>
        <tr>
          <th>2016-08-19</th>
          <td>Malaga</td>
          <td>Osasuna</td>
          <td>Spain</td>
          <td>1</td>
          <td>2017</td>
          <td>72.57</td>
          <td>56.93</td>
          <td>0.5475</td>
          <td>0.1897</td>
          <td>0.2628</td>
          <td>1.56</td>
          <td>0.70</td>
          <td>63.805561</td>
        </tr>
        <tr>
          <th>2016-08-20</th>
          <td>Barcelona</td>
          <td>Betis</td>
          <td>Spain</td>
          <td>1</td>
          <td>2017</td>
          <td>96.35</td>
          <td>69.95</td>
          <td>0.9591</td>
          <td>0.0071</td>
          <td>0.0337</td>
          <td>3.40</td>
          <td>0.42</td>
          <td>81.054510</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>2021-10-28</th>
          <td>Granada</td>
          <td>Getafe</td>
          <td>Spain</td>
          <td>1</td>
          <td>2022</td>
          <td>58.45</td>
          <td>65.57</td>
          <td>0.3631</td>
          <td>0.3127</td>
          <td>0.3242</td>
          <td>1.05</td>
          <td>0.95</td>
          <td>61.805620</td>
        </tr>
        <tr>
          <th>2021-10-28</th>
          <td>Celta</td>
          <td>Sociedad</td>
          <td>Spain</td>
          <td>1</td>
          <td>2022</td>
          <td>71.68</td>
          <td>78.29</td>
          <td>0.3206</td>
          <td>0.3957</td>
          <td>0.2837</td>
          <td>1.17</td>
          <td>1.34</td>
          <td>74.839331</td>
        </tr>
        <tr>
          <th>2021-10-28</th>
          <td>Levante</td>
          <td>Ath Madrid</td>
          <td>Spain</td>
          <td>1</td>
          <td>2022</td>
          <td>63.23</td>
          <td>84.94</td>
          <td>0.1873</td>
          <td>0.5664</td>
          <td>0.2463</td>
          <td>0.91</td>
          <td>1.77</td>
          <td>72.494516</td>
        </tr>
        <tr>
          <th>2021-10-28</th>
          <td>Granada</td>
          <td>Getafe</td>
          <td>Spain</td>
          <td>1</td>
          <td>2022</td>
          <td>58.45</td>
          <td>65.57</td>
          <td>0.3631</td>
          <td>0.3127</td>
          <td>0.3242</td>
          <td>1.05</td>
          <td>0.95</td>
          <td>61.805620</td>
        </tr>
        <tr>
          <th>2021-12-20</th>
          <td>Levante</td>
          <td>Valencia</td>
          <td>Spain</td>
          <td>1</td>
          <td>2022</td>
          <td>60.85</td>
          <td>72.40</td>
          <td>0.3228</td>
          <td>0.4059</td>
          <td>0.2713</td>
          <td>1.26</td>
          <td>1.45</td>
          <td>66.124428</td>
        </tr>
      </tbody>
    </table>
    <p>18815 rows × 13 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 36-37

The targets:

.. GENERATED FROM PYTHON SOURCE LINES 37-39

.. code-block:: default

    Y_train






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>away_win__full_time_goals</th>
          <th>draw__full_time_goals</th>
          <th>home_win__full_time_goals</th>
          <th>over_2.5__full_time_goals</th>
          <th>under_2.5__full_time_goals</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>1</th>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2</th>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>3</th>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>4</th>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>18810</th>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>18811</th>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>18812</th>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>18813</th>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>18814</th>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
        </tr>
      </tbody>
    </table>
    <p>18815 rows × 5 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 40-42

Training a multi-output classifier
##############################################################################

.. GENERATED FROM PYTHON SOURCE LINES 44-46

We train a :class:`~sklearn.neighbors.KNeighborsClassifier` using only numerical
features from the input data. We also use the extracted targets.

.. GENERATED FROM PYTHON SOURCE LINES 46-55

.. code-block:: default


    num_features = [
        col
        for col in X_train.columns
        if X_train[col].dtype in (np.dtype(int), np.dtype(float))
    ]
    clf = KNeighborsClassifier()
    clf.fit(X_train[num_features], Y_train)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    KNeighborsClassifier()



.. GENERATED FROM PYTHON SOURCE LINES 56-58

Extracting the fixtures data
##############################################################################

.. GENERATED FROM PYTHON SOURCE LINES 60-62

We extract the fixtures data. The columns by default match the columns of the
training data.

.. GENERATED FROM PYTHON SOURCE LINES 62-65

.. code-block:: default


    X_fix, _, Odds_fix = dataloader.extract_fixtures_data()








.. GENERATED FROM PYTHON SOURCE LINES 66-67

The input data:

.. GENERATED FROM PYTHON SOURCE LINES 67-69

.. code-block:: default

    X_fix






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>home_team</th>
          <th>away_team</th>
          <th>league</th>
          <th>division</th>
          <th>year</th>
          <th>home_team_soccer_power_index</th>
          <th>away_team_soccer_power_index</th>
          <th>home_team_probability_win</th>
          <th>away_team_probability_win</th>
          <th>probability_draw</th>
          <th>home_team_projected_score</th>
          <th>away_team_projected_score</th>
          <th>match_quality</th>
        </tr>
        <tr>
          <th>date</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>2021-12-22</th>
          <td>Heracles</td>
          <td>Cambuur</td>
          <td>Netherlands</td>
          <td>1</td>
          <td>2022</td>
          <td>46.71</td>
          <td>40.26</td>
          <td>0.5205</td>
          <td>0.2328</td>
          <td>0.2467</td>
          <td>1.74</td>
          <td>1.09</td>
          <td>43.245823</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Willem II</td>
          <td>Nijmegen</td>
          <td>Netherlands</td>
          <td>1</td>
          <td>2022</td>
          <td>38.74</td>
          <td>44.15</td>
          <td>0.4051</td>
          <td>0.3270</td>
          <td>0.2679</td>
          <td>1.44</td>
          <td>1.26</td>
          <td>41.268452</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Heerenveen</td>
          <td>Feyenoord</td>
          <td>Netherlands</td>
          <td>1</td>
          <td>2022</td>
          <td>46.16</td>
          <td>70.41</td>
          <td>0.1798</td>
          <td>0.5946</td>
          <td>0.2256</td>
          <td>0.97</td>
          <td>1.95</td>
          <td>55.762642</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Napoli</td>
          <td>Spezia</td>
          <td>Italy</td>
          <td>1</td>
          <td>2022</td>
          <td>78.97</td>
          <td>48.96</td>
          <td>0.7386</td>
          <td>0.0900</td>
          <td>0.1714</td>
          <td>2.30</td>
          <td>0.66</td>
          <td>60.445106</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Empoli</td>
          <td>Milan</td>
          <td>Italy</td>
          <td>1</td>
          <td>2022</td>
          <td>55.62</td>
          <td>75.96</td>
          <td>0.1797</td>
          <td>0.6030</td>
          <td>0.2173</td>
          <td>1.00</td>
          <td>2.01</td>
          <td>64.217893</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Verona</td>
          <td>Fiorentina</td>
          <td>Italy</td>
          <td>1</td>
          <td>2022</td>
          <td>63.03</td>
          <td>69.60</td>
          <td>0.3125</td>
          <td>0.4226</td>
          <td>0.2649</td>
          <td>1.22</td>
          <td>1.46</td>
          <td>66.152273</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Ajax</td>
          <td>For Sittard</td>
          <td>Netherlands</td>
          <td>1</td>
          <td>2022</td>
          <td>88.91</td>
          <td>35.23</td>
          <td>0.9383</td>
          <td>0.0124</td>
          <td>0.0493</td>
          <td>3.76</td>
          <td>0.36</td>
          <td>50.463981</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Roma</td>
          <td>Sampdoria</td>
          <td>Italy</td>
          <td>1</td>
          <td>2022</td>
          <td>73.22</td>
          <td>58.23</td>
          <td>0.6161</td>
          <td>0.1725</td>
          <td>0.2114</td>
          <td>2.07</td>
          <td>1.00</td>
          <td>64.870302</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Inter</td>
          <td>Torino</td>
          <td>Italy</td>
          <td>1</td>
          <td>2022</td>
          <td>86.52</td>
          <td>65.47</td>
          <td>0.7361</td>
          <td>0.0884</td>
          <td>0.1755</td>
          <td>2.24</td>
          <td>0.63</td>
          <td>74.537330</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Venezia</td>
          <td>Lazio</td>
          <td>Italy</td>
          <td>1</td>
          <td>2022</td>
          <td>48.78</td>
          <td>67.64</td>
          <td>0.2422</td>
          <td>0.5123</td>
          <td>0.2455</td>
          <td>1.11</td>
          <td>1.72</td>
          <td>56.682343</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Sassuolo</td>
          <td>Bologna</td>
          <td>Italy</td>
          <td>1</td>
          <td>2022</td>
          <td>66.22</td>
          <td>62.26</td>
          <td>0.4690</td>
          <td>0.2872</td>
          <td>0.2438</td>
          <td>1.72</td>
          <td>1.29</td>
          <td>64.178973</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Troyes</td>
          <td>Brest</td>
          <td>France</td>
          <td>1</td>
          <td>2022</td>
          <td>51.80</td>
          <td>58.17</td>
          <td>0.3913</td>
          <td>0.3345</td>
          <td>0.2742</td>
          <td>1.34</td>
          <td>1.22</td>
          <td>54.800509</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>St Etienne</td>
          <td>Nantes</td>
          <td>France</td>
          <td>1</td>
          <td>2022</td>
          <td>47.29</td>
          <td>58.99</td>
          <td>0.3502</td>
          <td>0.3690</td>
          <td>0.2807</td>
          <td>1.21</td>
          <td>1.25</td>
          <td>52.495994</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Clermont</td>
          <td>Strasbourg</td>
          <td>France</td>
          <td>1</td>
          <td>2022</td>
          <td>53.40</td>
          <td>66.23</td>
          <td>0.3004</td>
          <td>0.4410</td>
          <td>0.2586</td>
          <td>1.23</td>
          <td>1.55</td>
          <td>59.127008</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Montpellier</td>
          <td>Angers</td>
          <td>France</td>
          <td>1</td>
          <td>2022</td>
          <td>58.37</td>
          <td>57.60</td>
          <td>0.4522</td>
          <td>0.2760</td>
          <td>0.2718</td>
          <td>1.45</td>
          <td>1.07</td>
          <td>57.982444</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Monaco</td>
          <td>Rennes</td>
          <td>France</td>
          <td>1</td>
          <td>2022</td>
          <td>72.15</td>
          <td>71.16</td>
          <td>0.4255</td>
          <td>0.3071</td>
          <td>0.2674</td>
          <td>1.45</td>
          <td>1.19</td>
          <td>71.651580</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Marseille</td>
          <td>Reims</td>
          <td>France</td>
          <td>1</td>
          <td>2022</td>
          <td>66.33</td>
          <td>55.58</td>
          <td>0.5956</td>
          <td>0.1437</td>
          <td>0.2608</td>
          <td>1.55</td>
          <td>0.61</td>
          <td>60.481034</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Lyon</td>
          <td>Metz</td>
          <td>France</td>
          <td>1</td>
          <td>2022</td>
          <td>67.70</td>
          <td>46.64</td>
          <td>0.6598</td>
          <td>0.1421</td>
          <td>0.1981</td>
          <td>2.18</td>
          <td>0.90</td>
          <td>55.230506</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Lorient</td>
          <td>Paris SG</td>
          <td>France</td>
          <td>1</td>
          <td>2022</td>
          <td>48.68</td>
          <td>83.02</td>
          <td>0.1287</td>
          <td>0.6864</td>
          <td>0.1849</td>
          <td>0.90</td>
          <td>2.32</td>
          <td>61.373024</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Ath Bilbao</td>
          <td>Real Madrid</td>
          <td>Spain</td>
          <td>1</td>
          <td>2022</td>
          <td>75.99</td>
          <td>85.38</td>
          <td>0.2709</td>
          <td>0.4673</td>
          <td>0.2618</td>
          <td>1.16</td>
          <td>1.61</td>
          <td>80.411801</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Bordeaux</td>
          <td>Lille</td>
          <td>France</td>
          <td>1</td>
          <td>2022</td>
          <td>50.54</td>
          <td>72.56</td>
          <td>0.2261</td>
          <td>0.5287</td>
          <td>0.2452</td>
          <td>1.05</td>
          <td>1.73</td>
          <td>59.580543</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Gaziantep</td>
          <td>Alanyaspor</td>
          <td>Turkey</td>
          <td>1</td>
          <td>2022</td>
          <td>37.78</td>
          <td>39.46</td>
          <td>0.4252</td>
          <td>0.3291</td>
          <td>0.2457</td>
          <td>1.66</td>
          <td>1.44</td>
          <td>38.601730</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Sivasspor</td>
          <td>Rizespor</td>
          <td>Turkey</td>
          <td>1</td>
          <td>2022</td>
          <td>49.52</td>
          <td>27.33</td>
          <td>0.6486</td>
          <td>0.1383</td>
          <td>0.2131</td>
          <td>1.99</td>
          <td>0.79</td>
          <td>35.221382</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Hatayspor</td>
          <td>Konyaspor</td>
          <td>Turkey</td>
          <td>1</td>
          <td>2022</td>
          <td>40.65</td>
          <td>46.33</td>
          <td>0.3272</td>
          <td>0.3898</td>
          <td>0.2829</td>
          <td>1.15</td>
          <td>1.29</td>
          <td>43.304541</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Karagumruk</td>
          <td>Fenerbahce</td>
          <td>Turkey</td>
          <td>1</td>
          <td>2022</td>
          <td>37.99</td>
          <td>52.76</td>
          <td>0.2553</td>
          <td>0.5074</td>
          <td>0.2373</td>
          <td>1.24</td>
          <td>1.84</td>
          <td>44.173056</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Utrecht</td>
          <td>Twente</td>
          <td>Netherlands</td>
          <td>1</td>
          <td>2022</td>
          <td>60.97</td>
          <td>52.88</td>
          <td>0.5129</td>
          <td>0.2331</td>
          <td>0.2541</td>
          <td>1.67</td>
          <td>1.04</td>
          <td>56.637569</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Nice</td>
          <td>Lens</td>
          <td>France</td>
          <td>1</td>
          <td>2022</td>
          <td>63.61</td>
          <td>61.16</td>
          <td>0.4798</td>
          <td>0.2643</td>
          <td>0.2560</td>
          <td>1.61</td>
          <td>1.13</td>
          <td>62.360946</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Granada</td>
          <td>Ath Madrid</td>
          <td>Spain</td>
          <td>1</td>
          <td>2022</td>
          <td>61.19</td>
          <td>83.46</td>
          <td>0.1711</td>
          <td>0.6003</td>
          <td>0.2286</td>
          <td>0.93</td>
          <td>1.94</td>
          <td>70.610680</td>
        </tr>
        <tr>
          <th>2021-12-23</th>
          <td>Yeni Malatyaspor</td>
          <td>Kayserispor</td>
          <td>Turkey</td>
          <td>1</td>
          <td>2022</td>
          <td>26.13</td>
          <td>32.94</td>
          <td>0.3460</td>
          <td>0.3717</td>
          <td>0.2823</td>
          <td>1.20</td>
          <td>1.26</td>
          <td>29.142448</td>
        </tr>
        <tr>
          <th>2021-12-23</th>
          <td>Besiktas</td>
          <td>Goztep</td>
          <td>Turkey</td>
          <td>1</td>
          <td>2022</td>
          <td>46.31</td>
          <td>30.75</td>
          <td>0.5722</td>
          <td>0.2136</td>
          <td>0.2141</td>
          <td>2.13</td>
          <td>1.24</td>
          <td>36.959058</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 70-71

The market average odds:

.. GENERATED FROM PYTHON SOURCE LINES 71-73

.. code-block:: default

    Odds_fix






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>market_average__away_win__odds</th>
          <th>market_average__draw__odds</th>
          <th>market_average__home_win__odds</th>
          <th>market_average__over_2.5__odds</th>
          <th>market_average__under_2.5__odds</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>3.37</td>
          <td>3.76</td>
          <td>2.03</td>
          <td>1.65</td>
          <td>2.23</td>
        </tr>
        <tr>
          <th>1</th>
          <td>2.85</td>
          <td>3.26</td>
          <td>2.51</td>
          <td>1.91</td>
          <td>1.89</td>
        </tr>
        <tr>
          <th>2</th>
          <td>1.53</td>
          <td>4.34</td>
          <td>5.84</td>
          <td>1.65</td>
          <td>2.25</td>
        </tr>
        <tr>
          <th>3</th>
          <td>12.17</td>
          <td>6.27</td>
          <td>1.25</td>
          <td>1.47</td>
          <td>2.68</td>
        </tr>
        <tr>
          <th>4</th>
          <td>1.76</td>
          <td>3.99</td>
          <td>4.46</td>
          <td>1.57</td>
          <td>2.40</td>
        </tr>
        <tr>
          <th>5</th>
          <td>2.43</td>
          <td>3.45</td>
          <td>2.89</td>
          <td>1.70</td>
          <td>2.16</td>
        </tr>
        <tr>
          <th>6</th>
          <td>41.22</td>
          <td>16.43</td>
          <td>1.04</td>
          <td>1.16</td>
          <td>4.93</td>
        </tr>
        <tr>
          <th>7</th>
          <td>5.62</td>
          <td>4.32</td>
          <td>1.57</td>
          <td>1.63</td>
          <td>2.30</td>
        </tr>
        <tr>
          <th>8</th>
          <td>9.50</td>
          <td>5.41</td>
          <td>1.33</td>
          <td>1.62</td>
          <td>2.34</td>
        </tr>
        <tr>
          <th>9</th>
          <td>1.90</td>
          <td>3.63</td>
          <td>4.13</td>
          <td>1.81</td>
          <td>2.02</td>
        </tr>
        <tr>
          <th>10</th>
          <td>3.55</td>
          <td>3.68</td>
          <td>2.03</td>
          <td>1.60</td>
          <td>2.35</td>
        </tr>
        <tr>
          <th>11</th>
          <td>2.86</td>
          <td>3.34</td>
          <td>2.50</td>
          <td>1.90</td>
          <td>1.92</td>
        </tr>
        <tr>
          <th>12</th>
          <td>2.79</td>
          <td>3.32</td>
          <td>2.58</td>
          <td>2.02</td>
          <td>1.81</td>
        </tr>
        <tr>
          <th>13</th>
          <td>2.43</td>
          <td>3.38</td>
          <td>2.94</td>
          <td>1.93</td>
          <td>1.89</td>
        </tr>
        <tr>
          <th>14</th>
          <td>3.42</td>
          <td>3.30</td>
          <td>2.21</td>
          <td>1.97</td>
          <td>1.85</td>
        </tr>
        <tr>
          <th>15</th>
          <td>3.20</td>
          <td>3.49</td>
          <td>2.23</td>
          <td>1.87</td>
          <td>1.96</td>
        </tr>
        <tr>
          <th>16</th>
          <td>5.44</td>
          <td>3.74</td>
          <td>1.68</td>
          <td>2.17</td>
          <td>1.70</td>
        </tr>
        <tr>
          <th>17</th>
          <td>8.12</td>
          <td>5.41</td>
          <td>1.35</td>
          <td>1.46</td>
          <td>2.69</td>
        </tr>
        <tr>
          <th>18</th>
          <td>1.38</td>
          <td>5.15</td>
          <td>7.88</td>
          <td>1.54</td>
          <td>2.47</td>
        </tr>
        <tr>
          <th>19</th>
          <td>2.17</td>
          <td>3.49</td>
          <td>3.37</td>
          <td>1.99</td>
          <td>1.84</td>
        </tr>
        <tr>
          <th>20</th>
          <td>1.81</td>
          <td>3.82</td>
          <td>4.29</td>
          <td>1.79</td>
          <td>2.04</td>
        </tr>
        <tr>
          <th>21</th>
          <td>2.90</td>
          <td>3.42</td>
          <td>2.34</td>
          <td>1.83</td>
          <td>1.97</td>
        </tr>
        <tr>
          <th>22</th>
          <td>5.48</td>
          <td>4.00</td>
          <td>1.59</td>
          <td>1.86</td>
          <td>1.93</td>
        </tr>
        <tr>
          <th>23</th>
          <td>3.00</td>
          <td>3.35</td>
          <td>2.33</td>
          <td>1.99</td>
          <td>1.82</td>
        </tr>
        <tr>
          <th>24</th>
          <td>2.13</td>
          <td>3.49</td>
          <td>3.27</td>
          <td>1.82</td>
          <td>1.98</td>
        </tr>
        <tr>
          <th>25</th>
          <td>4.25</td>
          <td>3.87</td>
          <td>1.78</td>
          <td>1.78</td>
          <td>2.04</td>
        </tr>
        <tr>
          <th>26</th>
          <td>3.53</td>
          <td>3.45</td>
          <td>2.11</td>
          <td>1.85</td>
          <td>1.97</td>
        </tr>
        <tr>
          <th>27</th>
          <td>1.61</td>
          <td>3.77</td>
          <td>6.28</td>
          <td>2.14</td>
          <td>1.73</td>
        </tr>
        <tr>
          <th>28</th>
          <td>2.99</td>
          <td>3.32</td>
          <td>2.34</td>
          <td>1.94</td>
          <td>1.85</td>
        </tr>
        <tr>
          <th>29</th>
          <td>4.98</td>
          <td>4.11</td>
          <td>1.62</td>
          <td>1.64</td>
          <td>2.23</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 74-76

Estimating the value bets
##############################################################################

.. GENERATED FROM PYTHON SOURCE LINES 78-79

We can estimate the value bets by using the fitted classifier.

.. GENERATED FROM PYTHON SOURCE LINES 79-93

.. code-block:: default


    Y_pred_prob = np.concatenate(
        [prob[:, 1].reshape(-1, 1) for prob in clf.predict_proba(X_fix[num_features])],
        axis=1,
    )
    X_fix_info = X_fix[['home_team', 'away_team']].reset_index()
    value_bets = pd.concat([X_fix_info, Y_pred_prob * Odds_fix > 1], axis=1).set_index(
        'date'
    )
    value_bets.rename(
        columns={
            col: col.split('__')[1] for col in value_bets.columns if col.endswith('odds')
        }
    )





.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>home_team</th>
          <th>away_team</th>
          <th>away_win</th>
          <th>draw</th>
          <th>home_win</th>
          <th>over_2.5</th>
          <th>under_2.5</th>
        </tr>
        <tr>
          <th>date</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>2021-12-22</th>
          <td>Heracles</td>
          <td>Cambuur</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Willem II</td>
          <td>Nijmegen</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Heerenveen</td>
          <td>Feyenoord</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Napoli</td>
          <td>Spezia</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Empoli</td>
          <td>Milan</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Verona</td>
          <td>Fiorentina</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Ajax</td>
          <td>For Sittard</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Roma</td>
          <td>Sampdoria</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Inter</td>
          <td>Torino</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Venezia</td>
          <td>Lazio</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Sassuolo</td>
          <td>Bologna</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Troyes</td>
          <td>Brest</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>St Etienne</td>
          <td>Nantes</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Clermont</td>
          <td>Strasbourg</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Montpellier</td>
          <td>Angers</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Monaco</td>
          <td>Rennes</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Marseille</td>
          <td>Reims</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Lyon</td>
          <td>Metz</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Lorient</td>
          <td>Paris SG</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Ath Bilbao</td>
          <td>Real Madrid</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Bordeaux</td>
          <td>Lille</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Gaziantep</td>
          <td>Alanyaspor</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Sivasspor</td>
          <td>Rizespor</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Hatayspor</td>
          <td>Konyaspor</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Karagumruk</td>
          <td>Fenerbahce</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Utrecht</td>
          <td>Twente</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Nice</td>
          <td>Lens</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2021-12-22</th>
          <td>Granada</td>
          <td>Ath Madrid</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
          <td>True</td>
        </tr>
        <tr>
          <th>2021-12-23</th>
          <td>Yeni Malatyaspor</td>
          <td>Kayserispor</td>
          <td>True</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>False</td>
        </tr>
        <tr>
          <th>2021-12-23</th>
          <td>Besiktas</td>
          <td>Goztep</td>
          <td>False</td>
          <td>False</td>
          <td>True</td>
          <td>True</td>
          <td>False</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  39.046 seconds)


.. _sphx_glr_download_auto_examples_machine-learning_estimate_soccer_value_bets.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: estimate_soccer_value_bets.py <estimate_soccer_value_bets.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: estimate_soccer_value_bets.ipynb <estimate_soccer_value_bets.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
