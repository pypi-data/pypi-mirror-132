(self.webpackChunk_jupyter_widgets_jupyterlab_manager=self.webpackChunk_jupyter_widgets_jupyterlab_manager||[]).push([[150],{6110:(e,t,o)=>{"use strict";o.r(t),o.d(t,{ManagerBase:()=>g,base64ToBuffer:()=>m,bufferToBase64:()=>a,bufferToHex:()=>l,hexToBuffer:()=>i,serialize_state:()=>w});var r=o(1694),n=o(5766);const s=["00","01","02","03","04","05","06","07","08","09","0A","0B","0C","0D","0E","0F","10","11","12","13","14","15","16","17","18","19","1A","1B","1C","1D","1E","1F","20","21","22","23","24","25","26","27","28","29","2A","2B","2C","2D","2E","2F","30","31","32","33","34","35","36","37","38","39","3A","3B","3C","3D","3E","3F","40","41","42","43","44","45","46","47","48","49","4A","4B","4C","4D","4E","4F","50","51","52","53","54","55","56","57","58","59","5A","5B","5C","5D","5E","5F","60","61","62","63","64","65","66","67","68","69","6A","6B","6C","6D","6E","6F","70","71","72","73","74","75","76","77","78","79","7A","7B","7C","7D","7E","7F","80","81","82","83","84","85","86","87","88","89","8A","8B","8C","8D","8E","8F","90","91","92","93","94","95","96","97","98","99","9A","9B","9C","9D","9E","9F","A0","A1","A2","A3","A4","A5","A6","A7","A8","A9","AA","AB","AC","AD","AE","AF","B0","B1","B2","B3","B4","B5","B6","B7","B8","B9","BA","BB","BC","BD","BE","BF","C0","C1","C2","C3","C4","C5","C6","C7","C8","C9","CA","CB","CC","CD","CE","CF","D0","D1","D2","D3","D4","D5","D6","D7","D8","D9","DA","DB","DC","DD","DE","DF","E0","E1","E2","E3","E4","E5","E6","E7","E8","E9","EA","EB","EC","ED","EE","EF","F0","F1","F2","F3","F4","F5","F6","F7","F8","F9","FA","FB","FC","FD","FE","FF"];function l(e){const t=new Uint8Array(e),o=[];for(let e=0;e<t.length;e++)o.push(s[t[e]]);return o.join("")}function i(e){const t=new Uint8Array(e.length/2);for(let o=0;o<e.length;o+=2)t[o/2]=parseInt(e.slice(o,o+2),16);return t.buffer}function a(e){return(0,n.JQ)(new Uint8Array(e))}function m(e){return(0,n.b$)(e).buffer}const d=/(\$\$?|\\(?:begin|end)\{[a-z]*\*?\}|\\[{}$]|[{}]|(?:\n\s*)+|@@\d+@@|\\\\(?:\(|\)|\[|\]))/i;function c(e,t,o,r,n){let s=n.slice(e,t+1).join("").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");for(navigator&&"Microsoft Internet Explorer"===navigator.appName&&(s=s.replace(/(%[^\n]*)\n/g,"$1<br/>\n"));t>e;)n[t]="",t--;return n[e]="@@"+r.length+"@@",o&&(s=o(s)),r.push(s),n}var _=o(4330),u=o.n(_);const h=r.PROTOCOL_VERSION.split(".",1)[0];class g{constructor(){this.comm_target_name="jupyter.widget",this._models=Object.create(null)}setViewOptions(e={}){return e}create_view(e,t={}){const o=(0,r.uuid)(),n=e.state_change=e.state_change.then((async()=>{const n=e.get("_view_name"),s=e.get("_view_module");try{const r=new(await this.loadViewClass(n,s,e.get("_view_module_version")))({model:e,options:this.setViewOptions(t)});return r.listenTo(e,"destroy",r.remove),await r.render(),r.once("remove",(()=>{e.views&&delete e.views[o]})),r}catch(o){console.error(`Could not create a view for model id ${e.model_id}`);const l=`Failed to create view for '${n}' from module '${s}' with model '${e.name}' from module '${e.module}'`,i=new(r.createErrorWidgetModel(o,l)),a=new r.ErrorWidgetView({model:i,options:this.setViewOptions(t)});return await a.render(),a}}));return e.views&&(e.views[o]=n),n}callbacks(e){return{}}get_model(e){return this._models[e]}handle_comm_open(e,t){const o=(t.metadata||{}).version||"";if(o.split(".",1)[0]!==h){const e=`Wrong widget protocol version: received protocol version '${o}', but was expecting major version '${h}'`;return console.error(e),Promise.reject(e)}const n=t.content.data,s=n.buffer_paths||[],l=t.buffers||[];return(0,r.put_buffers)(n.state,s,l),this.new_model({model_name:n.state._model_name,model_module:n.state._model_module,model_module_version:n.state._model_module_version,comm:e},n.state).catch((0,r.reject)("Could not create a model.",!0))}new_widget(e,t={}){let o;if(void 0===e.view_name||void 0===e.view_module||void 0===e.view_module_version)return Promise.reject("new_widget(...) must be given view information in the options.");o=e.comm?Promise.resolve(e.comm):this._create_comm(this.comm_target_name,e.model_id,{state:{_model_module:e.model_module,_model_module_version:e.model_module_version,_model_name:e.model_name,_view_module:e.view_module,_view_module_version:e.view_module_version,_view_name:e.view_name}},{version:r.PROTOCOL_VERSION});const n=Object.assign({},e);return o.then((e=>(n.comm=e,this.new_model(n,t).then((e=>(e.sync("create",e),e))))),(()=>(n.model_id||(n.model_id=(0,r.uuid)()),this.new_model(n,t))))}register_model(e,t){this._models[e]=t,t.then((t=>{t.once("comm:close",(()=>{delete this._models[e]}))}))}async new_model(e,t={}){var o,r;const n=null!==(o=e.model_id)&&void 0!==o?o:null===(r=e.comm)||void 0===r?void 0:r.comm_id;if(!n)throw new Error("Neither comm nor model_id provided in options object. At least one must exist.");e.model_id=n;const s=this._make_model(e,t);return this.register_model(n,s),await s}async _make_model(e,t={}){const o=e.model_id,n=this.loadModelClass(e.model_name,e.model_module,e.model_module_version);let s;const l=(e,t)=>new(r.createErrorWidgetModel(e,t));try{s=await n}catch(e){const t="Could not instantiate widget";return console.error(t),l(e,t)}if(!s){const t="Could not instantiate widget";return console.error(t),l(new Error(`Cannot find model module ${e.model_module}@${e.model_module_version}, ${e.model_name}`),t)}let i;try{const r=await s._deserialize_state(t,this);i=new s(r,{widget_manager:this,model_id:o,comm:e.comm})}catch(t){console.error(t),i=l(t,`Model class '${e.model_name}' from module '${e.model_module}' is loaded but can not be instantiated`)}return i.name=e.model_name,i.module=e.model_module,i}clear_state(){return(0,r.resolvePromisesDict)(this._models).then((e=>{Object.keys(e).forEach((t=>e[t].close())),this._models=Object.create(null)}))}get_state(e={}){const t=Object.keys(this._models).map((e=>this._models[e]));return Promise.all(t).then((t=>w(t,e)))}set_state(e){if(!(e.version_major&&e.version_major<=2))throw"Unsupported widget state format";const t=e.state;return this._get_comm_info().then((e=>Promise.all(Object.keys(t).map((o=>{const n={base64:m,hex:i},s=t[o],l=s.state;if(s.buffers){const e=s.buffers.map((e=>e.path)),t=s.buffers.map((e=>new DataView(n[e.encoding](e.data))));(0,r.put_buffers)(s.state,e,t)}if(void 0!==this._models[o])return this._models[o].then((e=>e.constructor._deserialize_state(l||{},this).then((t=>(e.set_state(t),e)))));const a={model_id:o,model_name:s.model_name,model_module:s.model_module,model_module_version:s.model_module_version};return Object.prototype.hasOwnProperty.call(e,"model_id")?this._create_comm(this.comm_target_name,o).then((e=>(a.comm=e,this.new_model(a)))):this.new_model(a,l)})))))}disconnect(){Object.keys(this._models).forEach((e=>{this._models[e].then((e=>{e.comm_live=!1}))}))}resolveUrl(e){return Promise.resolve(e)}inline_sanitize(e){const t=function(e){const t=[];let o,r=null,n=null,s=null,l=0;/`/.test(e)?(e=e.replace(/~/g,"~T").replace(/(^|[^\\])(`+)([^\n]*?[^`\n])\2(?!`)/gm,(e=>e.replace(/\$/g,"~D"))),o=e=>e.replace(/~([TD])/g,((e,t)=>"T"===t?"~":"$"))):o=e=>e;let i=e.replace(/\r\n?/g,"\n").split(d);for(let e=1,a=i.length;e<a;e+=2){const a=i[e];"@"===a.charAt(0)?(i[e]="@@"+t.length+"@@",t.push(a)):null!==r?a===n?l?s=e:(i=c(r,e,o,t,i),r=null,n=null,s=null):a.match(/\n.*\n/)?(null!==s&&(e=s,i=c(r,e,o,t,i)),r=null,n=null,s=null,l=0):"{"===a?l++:"}"===a&&l&&l--:"$"===a||"$$"===a?(r=e,n=a,l=0):"\\\\("===a||"\\\\["===a?(r=e,n="("===a.slice(-1)?"\\\\)":"\\\\]",l=0):"begin"===a.substr(1,5)&&(r=e,n="\\end"+a.substr(6),l=0)}return null!==r&&null!==s&&(i=c(r,s,o,t,i),r=null,n=null,s=null),{text:o(i.join("")),math:t}}(e);var o,r,n;return r=(o=t.text,u()(o,{allowedTags:["a","abbr","b","code","em","i","img","li","ol","span","strong","ul"],allowedAttributes:{"*":["aria-*","style","title"],a:["href"],img:["src"],style:["media","type"]}})),n=t.math,r.replace(/@@(\d+)@@/g,((e,t)=>{let o=n[t];return"\\\\("===o.substr(0,3)&&"\\\\)"===o.substr(o.length-3)?o="\\("+o.substring(3,o.length-3)+"\\)":"\\\\["===o.substr(0,3)&&"\\\\]"===o.substr(o.length-3)&&(o="\\["+o.substring(3,o.length-3)+"\\]"),o}))}async loadModelClass(e,t,o){try{const r=this.loadClass(e,t,o);return await r,r}catch(o){console.error(o);const n=`Failed to load model class '${e}' from module '${t}'`;return r.createErrorWidgetModel(o,n)}}async loadViewClass(e,t,o){try{const r=this.loadClass(e,t,o);return await r,r}catch(o){console.error(o);const n=`Failed to load view class '${e}' from module '${t}'`;return r.createErrorWidgetView(o,n)}}filterExistingModelState(e){let t=e.state;return t=Object.keys(t).filter((e=>!this._models[e])).reduce(((e,o)=>(e[o]=t[o],e)),{}),Object.assign(Object.assign({},e),{state:t})}}function w(e,t={}){const o={};return e.forEach((e=>{const n=e.model_id,s=(0,r.remove_buffers)(e.serialize(e.get_state(t.drop_defaults))),l=s.buffers.map(((e,t)=>({data:a(e),path:s.buffer_paths[t],encoding:"base64"})));o[n]={model_name:e.name,model_module:e.module,model_module_version:e.get("_model_module_version"),state:s.state},l.length>0&&(o[n].buffers=l)})),{version_major:2,version_minor:0,state:o}}},6527:()=>{},6969:()=>{},2232:()=>{},4195:()=>{},3443:()=>{}}]);